language: go
go:
  - master
sudo: required
dist: trusty

services:
- docker

addons:
  apt:
    packages:
      - docker-ce

before_install:
- go get github.com/mattn/goveralls
- go get golang.org/x/tools/cmd/cover
- curl https://raw.githubusercontent.com/golang/dep/master/install.sh | sh

install:
- dep ensure --vendor-only

script:
- ./scripts/build.sh
- go test -cover -v -coverprofile=.coverprofile $(go list ./pkg/...)
- $GOPATH/bin/goveralls -service=travis-ci -coverprofile=.coverprofile

env:
  global:
  - secure: "nBtlasU42GvFCGuKgnlQsTvUS6l8AIi9Zzds54E8Eo6dy6sh4hlEs5DwQVAyIGo24WebrHj7uvbffoYLtVML5DMms/+iL7FpBG6R9eODoQOq4SluzBurpzMbP5fUdcN9XgxuF1fMReZ8OQjFKdEjuiN/ir9Sy/mDbUshwlJGyf25qjKsbAxMwyV7f1iVmvuWQv7fJm2/EKs26B/esB/yC8rlQKeGfvSre/NA8cX3dkV+O7RmoP4oJ8a+MLdMuUKGyrJVUG9ejG3tUMxPSckHo+EwTwBMo0g45W3XhgslectSbHEx0tOlg26NnNgP6x1LkZ6C/2ZLs7VDyZ5EZXxeD/SeVca+xi0zLcoUGM1aBgzXGUbw+aGmG5z33UW3bk6OY7FG62qeuD0EANPJOkQ2ORMoDJH8PUsXtQAPeESmfYmvRayF3Qofy97Cvi9QU9PaiMa0tgh/JZFJQ/OaIBnjn0j+v63YnhCaDRTV4f8rl68Zs3fSyIjf5YWYUQl8pOXoreMgyPk5pNwa93xoycJYZuWZLUv6MrcGfPWj0vw6lQZxtzkJuVF/KlUytG7gSVJRArRyW4EwaDUMT+FSk+gkyLLiW/QN4ulCTo1csUUZUC/GNhx43ckVsnLqOrYaltJhZ835oWopv1JnoPI/79xYxFYdtZYcM8UhmsWSBYLqHNk="
